<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>

    <title>팀 소개 page</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Gowun+Dodum&display=swap');

        * {
            font-family: 'Gowun Dodum', sans-serif;
        }

        .mybtn {
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
            margin-top: 10px;
            margin: 20px auto 20px auto;
        }

        .mb-3 {
            width: 500px;
            padding: 20px 20px 20px 20px;
            margin: 20px auto 20px auto;
            border: 1px solid black;
        }
    </style>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-analytics.js";
        import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { query, orderBy } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js"

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID",
            measurementId: "YOUR_MEASUREMENT_ID"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const db = getFirestore(app);

      
      
        $("#save").click(async function () {
            let name = $('#nick').val();
            let result = $('#comment').val();
            if (name.trim() === '' || result.trim() === '') {
                alert('닉네임과 댓글을 작성해주세요!');
                return;
            }
            
            $('#nick').val('');
            $('#comment').val('');
            
            let date = new Date().toLocaleDateString();
            let time = new Date().toLocaleTimeString();
            
            let doc = {
                'name': name,
                'result': result,
                'date': date,
                'time': time,
            
            };
            await addDoc(collection(db, "albums"), doc); 
            alert('저장 완료!');
            window.location.reload();
        });

       
             let docs = await getDocs(query(collection(db, "albums"), orderBy("time", "desc")));
            docs.forEach((doc) => {
                let row = doc.data();
                let name = row['name'];
                let date = row['date'];
                let result = row['result'];
                let time = row['time'];

                let temp_html = `<tr>
                    <td>${name}</td>
                    <td>${result}</td>
                    <td>${date}</td>
                    <td>${time}</td>
                  </tr>`;
                $('#visit').append(temp_html);
            });
        
    </script>
</head>

<body>
    <div class="mb-3">
        <label for="nick" class="form-label">닉네임</label>
        <input type="text" class="form-control" id="nick" placeholder="닉네임">
        <label for="comment" class="form-label">댓글</label>
        <textarea class="form-control" id="comment" rows="3"></textarea>
        <div class="mybtn">
            <button type="button" id="save" class="btn btn-primary">기록하기</button>
        </div>
    </div>
    <div>
        <div class="container">
            <table class="table" id="visit">
                <thead>
                    <tr>
                        <th width="10%" scope="col">작성자</th>
                        <th width="60%" scope="col">댓글 내용</th>
                        <th width="10%" scope="col">작성일자</th>
                        <th width=10% scope="col">작성시간</th>
                    </tr>
                </thead>

            </table>
        </div>
    </div>
    <div>
        
    </div>
    
</body>
